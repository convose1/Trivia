<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TechQuiz Pro - Multiplayer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .card-shadow { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04); }
    .option-card { transition: all 0.3s ease; cursor: pointer; }
    .option-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
    .option-card.selected { border-color: #667eea; background-color: #f3f4f6; }
    .option-card.correct { border-color: #10b981; background-color: #d1fae5; }
    .option-card.incorrect { border-color: #ef4444; background-color: #fee2e2; }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from {opacity:0; transform: translateY(10px);} to {opacity:1; transform: translateY(0);} }
    .progress-bar { transition: width 0.5s ease; }
    .pulse { animation: pulse 2s infinite; }
    @keyframes pulse { 0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);} }
    .timer { transition: all 0.3s ease; }
    .timer.warning { color:#f59e0b; }
    .timer.danger { color:#ef4444; }
    .timer-circle { stroke-dasharray: 283; stroke-dashoffset: 0; transform: rotate(-90deg); transform-origin:center; transition: stroke-dashoffset 1s linear; }
    /* Leaderboard strip */
    .leaderboard-strip { position: fixed; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.95); border-top: 1px solid #e5e7eb; backdrop-filter: blur(6px); }
    .avatar { width: 48px; height: 48px; border-radius: 9999px; object-fit: cover; }
    /* Custom select with consistent caret padding */
    .nice-select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="none" stroke="%236b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 8 10 12 14 8"/></svg>');
      background-repeat: no-repeat;
      background-position: right 12px center; /* move caret left */
      background-size: 16px 16px;
      padding-right: 2.5rem; /* room for caret */
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Welcome Screen -->
  <div id="welcomeScreen" class="min-h-screen gradient-bg flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl card-shadow p-8 md:p-12 max-w-md w-full fade-in">
      <div class="text-center mb-8">
        <i class="fas fa-laptop-code text-6xl text-purple-600 mb-4"></i>
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">TechQuiz Pro</h1>
        <p class="text-gray-600">Multiplayer – compete in real time!</p>
      </div>

      <form id="nameForm" class="space-y-6">
        <div>
          <label for="userName" class="block text-sm font-medium text-gray-700 mb-2">Enter Your Name</label>
          <input type="text" id="userName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition duration-200" placeholder="John Doe" />
        </div>
        <div>
          <label for="avatarUrl" class="block text-sm font-medium text-gray-700 mb-2">Avatar URL (optional)</label>
          <input type="url" id="avatarUrl" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition duration-200" placeholder="https://..." />
        </div>
        <button type="submit" class="w-full bg-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-purple-700 transform hover:scale-105 transition duration-200">Join Lobby <i class="fas fa-arrow-right ml-2"></i></button>
      </form>
      <div class="mt-8 text-center text-sm text-gray-600">
        <p><i class="fas fa-info-circle mr-1"></i> 10 questions • +10 for correct • -2 for wrong/timeout</p>
        <p><i class="fas fa-clock mr-1"></i> 10 seconds per question</p>
      </div>
    </div>
  </div>

  <!-- Lobby Screen -->
  <div id="lobbyScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl card-shadow p-8 md:p-10 max-w-xl w-full">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-1">Lobby</h2>
        <p class="text-gray-600">Choose a topic and start when everyone is ready.</p>
      </div>
      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Selected Topic</label>
          <select id="topicSelect" class="nice-select w-full pl-4 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition duration-200 cursor-pointer"></select>
        </div>
        <div class="flex items-end">
          <button id="startGameBtn" type="button" onclick="window.triggerStartGame && window.triggerStartGame()" class="w-full bg-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-purple-700 transform hover:scale-105 transition duration-200 cursor-pointer">Start Game</button>
        </div>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-2">Participants</p>
        <div id="lobbyParticipants" class="flex items-center gap-3 flex-wrap"></div>
      </div>
    </div>
  </div>

  <!-- Quiz Screen -->
  <div id="quizScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4 pb-24">
    <div class="bg-white rounded-2xl card-shadow p-6 md:p-8 max-w-2xl w-full">
      <!-- Header -->
      <div class="flex justify-between items-center mb-6">
        <div class="flex items-center space-x-4">
          <div class="bg-purple-100 p-3 rounded-lg"><i class="fas fa-user text-purple-600"></i></div>
          <div>
            <p class="text-sm text-gray-600">Player</p>
            <p id="playerName" class="font-semibold text-gray-800"></p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-sm text-gray-600">Score</p>
          <p id="currentScore" class="text-2xl font-bold text-purple-600">0</p>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="mb-8">
        <div class="flex justify-between text-sm text-gray-600 mb-2">
          <span>Question <span id="currentQuestion">1</span> of <span id="totalQuestions">10</span></span>
          <span id="progressPercent">0%</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-3">
          <div id="progressBar" class="progress-bar bg-purple-600 h-3 rounded-full" style="width: 0%"></div>
        </div>
      </div>

      <!-- Timer -->
      <div class="flex justify-center mb-6">
        <div class="relative w-16 h-16">
          <svg class="w-full h-full" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="8" />
            <circle id="timerCircle" class="timer-circle" cx="50" cy="50" r="45" fill="none" stroke="#6366f1" stroke-width="8" />
          </svg>
          <div class="absolute inset-0 flex items-center justify-center">
            <span id="timerText" class="text-lg font-bold text-gray-800">10</span>
          </div>
        </div>
      </div>

      <!-- Question -->
      <div class="mb-8">
        <h2 id="questionText" class="text-xl md:text-2xl font-semibold text-gray-800 mb-6 fade-in"></h2>
        <div id="optionsContainer" class="space-y-3"></div>
      </div>

      <!-- Next state hint -->
      <div class="text-center text-sm text-gray-500" id="statusHint"></div>
    </div>
  </div>

  <!-- Results Screen -->
  <div id="resultsScreen" class="hidden min-h-screen gradient-bg flex items-center justify-center p-4 pb-24">
    <div class="bg-white rounded-2xl card-shadow p-8 md:p-12 max-w-2xl w-full fade-in">
      <div class="text-center mb-8">
        <i id="resultIcon" class="text-6xl mb-4"></i>
        <h2 id="resultTitle" class="text-3xl font-bold text-gray-800 mb-2">Round Complete!</h2>
        <p class="text-gray-600">Your Final Score</p>
        <p id="finalScore" class="text-4xl font-bold text-purple-600 mt-2"></p>
      </div>

      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Selected Topic</label>
          <select id="topicSelectResults" class="nice-select w-full pl-4 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent transition duration-200 cursor-pointer"></select>
        </div>
        <div class="flex items-end">
          <button id="newGameBtn" class="w-full bg-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-purple-700 transform hover:scale-105 transition duration-200">New Game</button>
        </div>
      </div>

      <div>
        <p class="text-sm text-gray-600 mb-2">Participants</p>
        <div id="lobbyParticipantsResults" class="flex items-center gap-3 flex-wrap"></div>
      </div>
    </div>
  </div>

  <!-- Leaderboard strip -->
  <div id="leaderboardStrip" class="leaderboard-strip hidden">
    <div class="max-w-5xl mx-auto px-4 py-2">
      <div id="leaderboardList" class="flex items-center gap-4 overflow-x-auto no-scrollbar"></div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="./main.js?v=dev-1"></script>
</body>
</html>
